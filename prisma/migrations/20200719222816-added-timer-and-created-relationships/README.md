# Migration `20200719222816-added-timer-and-created-relationships`

This migration has been generated by briansayles at 7/19/2020, 10:28:16 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."User" ADD COLUMN "credits" integer  NOT NULL DEFAULT 0;

CREATE UNIQUE INDEX "Timer_tournamentId" ON "public"."Timer"("tournamentId")

ALTER TABLE "public"."Chip" ADD FOREIGN KEY ("tournamentId")REFERENCES "public"."Tournament"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Cost" ADD FOREIGN KEY ("tournamentId")REFERENCES "public"."Tournament"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Segment" ADD FOREIGN KEY ("tournamentId")REFERENCES "public"."Tournament"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Timer" ADD FOREIGN KEY ("tournamentId")REFERENCES "public"."Tournament"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Tournament" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200718225904-added-cost..20200719222816-added-timer-and-created-relationships
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -11,18 +11,26 @@
   id   String @default(cuid()) @id
   createdAt DateTime @default(now())
   updatedAt DateTime @default(now())
   name String
+  credits Int @default(0)
+  tournaments Tournament[]
 }
 model Tournament {
   id String @default(uuid()) @id
   createdAt DateTime
   updatedAt DateTime
+  user User @relation(fields: [userId], references: [id])
+  userId String
   title String
   subtitle String
   comments String
   game String
+  segments Segment[]
+  chips Chip[]
+  costs Cost[]
+  timer Timer
 }
 model Segment {
   id String @default(uuid()) @id
@@ -32,9 +40,11 @@
   sBlind Int
   bBlind Int
   ante Int
   game String
-}
+  tournament Tournament @relation(fields: [tournamentId], references: [id])
+  tournamentId String
+  }
 model Chip {
   id String @default(uuid()) @id
   createdAt DateTime
@@ -43,12 +53,31 @@
   color String
   rimColor String
   textColor String
   qtyAvailable Int
+  tournament Tournament @relation(fields: [tournamentId], references: [id])
+  tournamentId String
 }
 model Cost {
   id String @default(uuid()) @id
   costType String
   price Int
   chipStack Int
+  tournament Tournament @relation(fields: [tournamentId], references: [id])
+  tournamentId String
+}
+
+model Timer {
+  id String @default(uuid()) @id
+  active Boolean
+  createdAt DateTime
+  updatedAt DateTime
+  elapsed Int
+  oneMinuteRemainingSpeech String
+  playOneMinuteRemainingSound Boolean
+  endOfRoundSpeech String
+  playEndOfRoundSound Boolean
+  backgroundColor String
+  tournament Tournament @relation(fields: [tournamentId], references: [id])
+  tournamentId String
 }
```


