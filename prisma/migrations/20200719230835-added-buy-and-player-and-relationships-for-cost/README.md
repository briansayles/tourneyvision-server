# Migration `20200719230835-added-buy-and-player-and-relationships-for-cost`

This migration has been generated by briansayles at 7/19/2020, 11:08:35 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Buy" (
"costId" text  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"id" text  NOT NULL ,
"playerId" text   ,
"updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Player" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"id" text  NOT NULL ,
"name" text   ,
"updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY ("id"))

ALTER TABLE "public"."Buy" ADD FOREIGN KEY ("costId")REFERENCES "public"."Cost"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Buy" ADD FOREIGN KEY ("playerId")REFERENCES "public"."Player"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200719225056-added-payout-level-and-relationship-with-tournament..20200719230835-added-buy-and-player-and-relationships-for-cost
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -36,62 +36,81 @@
 model Segment {
   id String @default(uuid()) @id
   createdAt DateTime @default(now())
   updatedAt DateTime @default(now())
+  tournament Tournament @relation(fields: [tournamentId], references: [id])
+  tournamentId String
   duration Int
   sBlind Int
   bBlind Int
   ante Int
   game String
-  tournament Tournament @relation(fields: [tournamentId], references: [id])
-  tournamentId String
   }
 model Chip {
   id String @default(uuid()) @id
   createdAt DateTime @default(now())
   updatedAt DateTime @default(now())
+  tournament Tournament @relation(fields: [tournamentId], references: [id])
+  tournamentId String
   denom Int
   color String
   rimColor String
   textColor String
   qtyAvailable Int
-  tournament Tournament @relation(fields: [tournamentId], references: [id])
-  tournamentId String
 }
 model Cost {
   id String @default(uuid()) @id
   createdAt DateTime @default(now())
   updatedAt DateTime @default(now())
+  tournament Tournament @relation(fields: [tournamentId], references: [id])
+  tournamentId String
   costType String
   price Int
   chipStack Int
-  tournament Tournament @relation(fields: [tournamentId], references: [id])
-  tournamentId String
+  buys Buy[]
 }
+model Buy {
+  id String @default(uuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @default(now())
+  cost Cost @relation(fields: [costId], references: [id])
+  costId String
+  player Player? @relation(fields: [playerId], references: [id])
+  playerId String?
+}
+
+model Player {
+  id String @default(uuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @default(now())
+  name String?
+  buys Buy[]
+}
+
 model Timer {
   id String @default(uuid()) @id
   createdAt DateTime @default(now())
   updatedAt DateTime @default(now())
+  tournament Tournament @relation(fields: [tournamentId], references: [id])
+  tournamentId String
   active Boolean
   elapsed Int
   oneMinuteRemainingSpeech String
   playOneMinuteRemainingSound Boolean
   endOfRoundSpeech String
   playEndOfRoundSound Boolean
   backgroundColor String
-  tournament Tournament @relation(fields: [tournamentId], references: [id])
-  tournamentId String
 }
 model PayoutLevel {
   id String @default(uuid()) @id
   createdAt DateTime @default(now())
   updatedAt DateTime @default(now())
+  tournament Tournament @relation(fields: [tournamentId], references: [id])
+  tournamentId String
   levelNumber Int
   payCount Int
   playerCount Int
-  tournament Tournament @relation(fields: [tournamentId], references: [id])
-  tournamentId String
 }
```


